(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NORM_2D=1/47,exports.NORM_3D=1/103,exports.NORM_4D=1/30,exports.SQUISH_2D=(Math.sqrt(3)-1)/2,exports.SQUISH_3D=(Math.sqrt(4)-1)/3,exports.SQUISH_4D=(Math.sqrt(5)-1)/4,exports.STRETCH_2D=(1/Math.sqrt(3)-1)/2,exports.STRETCH_3D=(1/Math.sqrt(4)-1)/3,exports.STRETCH_4D=(1/Math.sqrt(5)-1)/4,exports.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],exports.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],exports.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],exports.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],exports.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],exports.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],exports.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],exports.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],exports.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],exports.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],exports.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],exports.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];

},{}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var constants_1=require("./constants"),Contribution2=function(){return function(t,n,s){this.dx=-n-t*constants_1.SQUISH_2D,this.dy=-s-t*constants_1.SQUISH_2D,this.xsb=n,this.ysb=s}}(),Contribution3=function(){return function(t,n,s,o){this.dx=-n-t*constants_1.SQUISH_3D,this.dy=-s-t*constants_1.SQUISH_3D,this.dz=-o-t*constants_1.SQUISH_3D,this.xsb=n,this.ysb=s,this.zsb=o}}(),Contribution4=function(){return function(t,n,s,o,r){this.dx=-n-t*constants_1.SQUISH_4D,this.dy=-s-t*constants_1.SQUISH_4D,this.dz=-o-t*constants_1.SQUISH_4D,this.dw=-r-t*constants_1.SQUISH_4D,this.xsb=n,this.ysb=s,this.zsb=o,this.wsb=r}}();function shuffleSeed(t){var n=new Uint32Array(1);return n[0]=1664525*t[0]+1013904223,n}var OpenSimplexNoise=function(){function t(t){this.initialize(),this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);for(var n=new Uint8Array(256),s=0;s<256;s++)n[s]=s;var o=new Uint32Array(1);o[0]=t,o=shuffleSeed(shuffleSeed(shuffleSeed(o)));for(s=255;s>=0;s--){o=shuffleSeed(o);var r=new Uint32Array(1);r[0]=(o[0]+31)%(s+1),r[0]<0&&(r[0]+=s+1),this.perm[s]=n[r[0]],this.perm2D[s]=14&this.perm[s],this.perm3D[s]=this.perm[s]%24*3,this.perm4D[s]=252&this.perm[s],n[r[0]]=n[s]}}return t.prototype.array2D=function(t,n){for(var s=new Array(t),o=0;o<t;o++){s[o]=new Array(n);for(var r=0;r<n;r++)s[o][r]=this.noise2D(o,r)}return s},t.prototype.array3D=function(t,n,s){for(var o=new Array(t),r=0;r<t;r++){o[r]=new Array(n);for(var a=0;a<n;a++){o[r][a]=new Array(s);for(var i=0;i<s;i++)o[r][a][i]=this.noise3D(r,a,i)}}return o},t.prototype.array4D=function(t,n,s,o){for(var r=new Array(t),a=0;a<t;a++){r[a]=new Array(n);for(var i=0;i<n;i++){r[a][i]=new Array(s);for(var e=0;e<s;e++){r[a][i][e]=new Array(o);for(var D=0;D<o;D++)r[a][i][e][D]=this.noise4D(a,i,e,D)}}}return r},t.prototype.noise2D=function(t,n){for(var s=(t+n)*constants_1.STRETCH_2D,o=t+s,r=n+s,a=Math.floor(o),i=Math.floor(r),e=(a+i)*constants_1.SQUISH_2D,D=t-(a+e),_=n-(i+e),c=o-a,p=r-i,u=c+p,h=c-p+1|u<<1|u+p<<2|u+c<<4,l=0,f=this.lookup2D[h];void 0!==f;f=f.next){var y=D+f.dx,d=_+f.dy,b=2-y*y-d*d;if(b>0){var S=a+f.xsb,v=i+f.ysb,x=this.perm[255&S],w=this.perm2D[x+v&255];l+=b*b*b*b*(constants_1.gradients2D[w]*y+constants_1.gradients2D[w+1]*d)}}return l*constants_1.NORM_2D},t.prototype.noise3D=function(t,n,s){for(var o=(t+n+s)*constants_1.STRETCH_3D,r=t+o,a=n+o,i=s+o,e=Math.floor(r),D=Math.floor(a),_=Math.floor(i),c=(e+D+_)*constants_1.SQUISH_3D,p=t-(e+c),u=n-(D+c),h=s-(_+c),l=r-e,f=a-D,y=i-_,d=l+f+y,b=f-y+1|l-f+1<<1|l-y+1<<2|d<<3|d+y<<5|d+f<<7|d+l<<9,S=0,v=this.lookup3D[b];void 0!==v;v=v.next){var x=p+v.dx,w=u+v.dy,m=h+v.dz,U=2-x*x-w*w-m*m;if(U>0){var g=e+v.xsb,k=D+v.ysb,A=_+v.zsb,C=this.perm[255&g],H=this.perm[C+k&255],M=this.perm3D[H+A&255];S+=U*U*U*U*(constants_1.gradients3D[M]*x+constants_1.gradients3D[M+1]*w+constants_1.gradients3D[M+2]*m)}}return S*constants_1.NORM_3D},t.prototype.noise4D=function(t,n,s,o){for(var r=(t+n+s+o)*constants_1.STRETCH_4D,a=t+r,i=n+r,e=s+r,D=o+r,_=Math.floor(a),c=Math.floor(i),p=Math.floor(e),u=Math.floor(D),h=(_+c+p+u)*constants_1.SQUISH_4D,l=t-(_+h),f=n-(c+h),y=s-(p+h),d=o-(u+h),b=a-_,S=i-c,v=e-p,x=D-u,w=b+S+v+x,m=v-x+1|S-v+1<<1|S-x+1<<2|b-S+1<<3|b-v+1<<4|b-x+1<<5|w<<6|w+x<<8|w+v<<11|w+S<<14|w+b<<17,U=0,g=this.lookup4D[m];void 0!==g;g=g.next){var k=l+g.dx,A=f+g.dy,C=y+g.dz,H=d+g.dw,M=2-k*k-A*A-C*C-H*H;if(M>0){var I=_+g.xsb,Q=c+g.ysb,z=p+g.zsb,P=u+g.wsb,O=this.perm[255&I],R=this.perm[O+Q&255],T=this.perm[R+z&255],N=this.perm4D[T+P&255];U+=M*M*M*M*(constants_1.gradients4D[N]*k+constants_1.gradients4D[N+1]*A+constants_1.gradients4D[N+2]*C+constants_1.gradients4D[N+3]*H)}}return U*constants_1.NORM_4D},t.prototype.initialize=function(){for(var t=[],n=0;n<constants_1.p2D.length;n+=4){for(var s=constants_1.base2D[constants_1.p2D[n]],o=null,r=null,a=0;a<s.length;a+=3)r=new Contribution2(s[a],s[a+1],s[a+2]),null===o?t[n/4]=r:o.next=r,o=r;r.next=new Contribution2(constants_1.p2D[n+1],constants_1.p2D[n+2],constants_1.p2D[n+3])}this.lookup2D=[];for(n=0;n<constants_1.lookupPairs2D.length;n+=2)this.lookup2D[constants_1.lookupPairs2D[n]]=t[constants_1.lookupPairs2D[n+1]];var i=[];for(n=0;n<constants_1.p3D.length;n+=9){for(s=constants_1.base3D[constants_1.p3D[n]],o=null,r=null,a=0;a<s.length;a+=4)r=new Contribution3(s[a],s[a+1],s[a+2],s[a+3]),null===o?i[n/9]=r:o.next=r,o=r;r.next=new Contribution3(constants_1.p3D[n+1],constants_1.p3D[n+2],constants_1.p3D[n+3],constants_1.p3D[n+4]),r.next.next=new Contribution3(constants_1.p3D[n+5],constants_1.p3D[n+6],constants_1.p3D[n+7],constants_1.p3D[n+8])}this.lookup3D=[];for(n=0;n<constants_1.lookupPairs3D.length;n+=2)this.lookup3D[constants_1.lookupPairs3D[n]]=i[constants_1.lookupPairs3D[n+1]];var e=[];for(n=0;n<constants_1.p4D.length;n+=16){for(s=constants_1.base4D[constants_1.p4D[n]],o=null,r=null,a=0;a<s.length;a+=5)r=new Contribution4(s[a],s[a+1],s[a+2],s[a+3],s[a+4]),null===o?e[n/16]=r:o.next=r,o=r;r.next=new Contribution4(constants_1.p4D[n+1],constants_1.p4D[n+2],constants_1.p4D[n+3],constants_1.p4D[n+4],constants_1.p4D[n+5]),r.next.next=new Contribution4(constants_1.p4D[n+6],constants_1.p4D[n+7],constants_1.p4D[n+8],constants_1.p4D[n+9],constants_1.p4D[n+10]),r.next.next.next=new Contribution4(constants_1.p4D[n+11],constants_1.p4D[n+12],constants_1.p4D[n+13],constants_1.p4D[n+14],constants_1.p4D[n+15])}this.lookup4D=[];for(n=0;n<constants_1.lookupPairs4D.length;n+=2)this.lookup4D[constants_1.lookupPairs4D[n]]=e[constants_1.lookupPairs4D[n+1]]},t}();exports.default=OpenSimplexNoise;

},{"./constants":1}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Asteroid=void 0;var _openSimplexNoise=_interopRequireDefault(require("open-simplex-noise")),_vmath=require("./engine/vmath.js"),_shape=require("./shape.js"),_utils=require("./utils.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function multiOctave(e,t){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.reduce(function(t,r){return t+r.mag*Math.pow(e.apply(void 0,_toConsumableArray(n.map(function(e){return e*r.freq}))),r.pow)},0)}}function coolSpots(e,t,r){for(var n=(r=r||{}).fthresh||10,a=[],o=1,i=0;i<t;i++){for(var l=Math.floor((i+1)/t*e.length),s=-1,u=-1/0;o<l;o++){var h=e[o-1],c=e[o],f=e[(o+1)%e.length],p=e[(o+2)%e.length],v=Math.max(Math.abs(f-c)-n,0),y=Math.max(h-c,0)+Math.max(p-f,0)-v/2;y>u&&(s=o,u=y)}-1!==s&&(a.push(s),s===l-1&&o++)}return a}var defaultOctaves=[{freq:1.5,mag:1/3,pow:1},{freq:3,mag:.25,pow:1},{freq:6,mag:.5,pow:5},{freq:12,mag:1/32,pow:1}],Asteroid=function(){function e(t,r,n,a){_classCallCheck(this,e),r=Math.max(3,r),this.centralAngle=2*Math.PI/r,this.fillimg=n;for(var o=void 0!==(a=a||{}).seed?a.seed:+new Date,i=a.octaves||defaultOctaves,l=new _openSimplexNoise.default(o),s=multiOctave(l.noise2D.bind(l),i),u=new Array(r),h=new Array(r),c=0;c<r;c++){var f=Math.cos(c*this.centralAngle),p=Math.sin(c*this.centralAngle);u[c]=t*(1+s(f,p)/2),h[c]=new _vmath.Vec2(f,p)}this.cool=coolSpots(u,10);var v=!0,y=!1,m=void 0;try{for(var d,g=this.cool[Symbol.iterator]();!(v=(d=g.next()).done);v=!0){var _=((c=d.value)+1)%u.length;u[c]=u[_]=(u[c]+u[_])/2}}catch(e){y=!0,m=e}finally{try{v||null==g.return||g.return()}finally{if(y)throw m}}var b=(0,_utils.mapMinMax)(u);this.minRadius=b.min,this.maxRadius=b.max,h.forEach(function(e,t){return e.imul(u[t])}),this.shape=new _shape.Polygon(h),this.length=r,this.pos=new _vmath.Vec2,this.grav=300}return _createClass(e,[{key:"getSlice",value:function(e){var t=e.pos.sub(this.pos).mag(),r=this.angleFor(e.pos),n=Math.atan(e.shape.radius/t);return[this.indexForAngle(r-n),this.indexForAngle(r+n)]}},{key:"angleFor",value:function(e){return Math.atan2(e.y-this.pos.y,e.x-this.pos.x)}},{key:"indexForAngle",value:function(e){return Math.floor(e/this.centralAngle)}},{key:"normalizeIndex",value:function(e){return(e%=this.length)<0?this.length+e:e}},{key:"getPoint",value:function(e){return this.shape.points[this.normalizeIndex(e)]}},{key:"isCool",value:function(e){e=this.normalizeIndex(e);for(var t=0,r=this.cool.length-1;t<=r;){var n=t+r>>1;if(this.cool[n]<e)t=n+1;else{if(!(this.cool[n]>e))return!0;r=n-1}}return!1}},{key:"draw",value:function(e,t){e.save(),this.shape.trace(e),e.fillStyle=e.createPattern(this.fillimg,"repeat");var r=1/(0,_utils.ceilPow)(t.scale);e.save(),e.scale(r,r),e.fill(),e.restore(),e.lineWidth=t.scale<1?1/t.scale:1,e.strokeStyle="#FFF",e.stroke(),e.lineWidth*=2.5,e.strokeStyle="#F08";var n=!0,a=!1,o=void 0;try{for(var i,l=this.cool[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value;e.beginPath(),e.moveTo.apply(e,_toConsumableArray(this.getPoint(s))),e.lineTo.apply(e,_toConsumableArray(this.getPoint(s+1))),e.stroke()}}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}e.restore()}}]),e}();exports.Asteroid=Asteroid;

},{"./engine/vmath.js":13,"./shape.js":15,"./utils.js":17,"open-simplex-noise":2}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Camera=void 0;var _vmath=require("./vmath.js");function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Camera=function(){function t(e,a,r){_classCallCheck(this,t),this.focus=e?_vmath.Vec2.from(e):new _vmath.Vec2,this._target=null,this.zoom=void 0!==a?a:1,this.view=1,this._za=null,this.rotation=r||0}return _createClass(t,[{key:"follow",value:function(t){this._target=t}},{key:"animZoom",value:function(t,e,a){this._za&&!a||(this._za={target:t,time:e})}},{key:"update",value:function(t){var e;(e=this.focus).set.apply(e,_toConsumableArray(this._target.pos)),this._za&&(t>=this._za.time?(this.zoom=this._za.target,this._za=null):(this.zoom*=Math.pow(this._za.target/this.zoom,t/this._za.time),this._za.time-=t))}},{key:"applyTransform",value:function(t){this.update(0),t.scale(this.scale,this.scale),t.rotate(this.rotation),t.translate(-this.focus.x,-this.focus.y)}},{key:"scale",get:function(){return this.view*this.zoom}}]),t}();exports.Camera=Camera;

},{"./vmath.js":13}],5:[function(require,module,exports){
"use strict";function lscol(o,t,r,s){var l=t.sub(o),n=r.sub(o),u=s.sub(r),i=l.cross(u);if(0===i){if(0!==n.cross(u))return null;var c=s.sub(o),e=r.sub(t),p=s.sub(t);return n.dot(c)<=0?{colinear:!0,point:o}:e.dot(p)<=0?{colinear:!0,point:t}:n.dot(e)<=0?{colinear:!0,point:r}:null}var d=n.cross(u)/i;if(d<0||d>1)return null;var a=n.cross(l)/i;return a<0||a>1?null:{colinear:!1,point:o.add(l.mul(d))}}function rtripolycol(o,t,r,s){for(var l=t.sub(r).perp().unit(),n=t.sub(o).unit(),u=r.sub(o).unit(),i=l.dot(t),c=n.cross(t),e=u.cross(r),p=n.dot(t),d=u.dot(r),a=0,b=null,f=null,v=[],h=0;h<s.length;h++){var y,x,g=s[h],m=s[(h+1)%s.length],_=(m.sub(g),n.cross(g)),j=u.cross(g),M=l.dot(g);if(_>c&&j<e&&M<i)(y=i-M)>a&&(a=y,b=l,f=g),v.push(g);if(x=lscol(g,m,o,t))(y=p-n.dot(x.point))>a&&(a=y,b=n,f=x.point),v.push(x.point);if(x=lscol(g,m,o,r))(y=d-u.dot(x.point))>a&&(a=y,b=u,f=x.point),v.push(x.point);(x=lscol(g,m,t,r))&&v.push(x.point)}return b?{norm:b,pivot:f,depth:a,intersections:v}:null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.lscol=lscol,exports.rtripolycol=rtripolycol;

},{}],6:[function(require,module,exports){
"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(r,e){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r)){var t=[],n=!0,a=!1,o=void 0;try{for(var i,s=r[Symbol.iterator]();!(n=(i=s.next()).done)&&(t.push(i.value),!e||t.length!==e);n=!0);}catch(r){a=!0,o=r}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return t}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function drawWrapper(r,e){r.save();try{return e()}finally{r.restore()}}function resetTransform(r){r.setTransform(1,0,0,1,0,0)}function background(r,e){r.save(),resetTransform(r),r.fillStyle=e,r.fillRect(0,0,r.canvas.width,r.canvas.height),r.restore()}function createImage(r,e){var t=document.createElement("canvas"),n=_slicedToArray(r,2);return t.width=n[0],t.height=n[1],e(t.getContext("2d")),new Promise(function(r,e){var n=new Image;n.src=t.toDataURL("image/png"),n.addEventListener("load",function(){r(n)}),n.addEventListener("error",function(r){e(r)})})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawWrapper=drawWrapper,exports.resetTransform=resetTransform,exports.background=background,exports.createImage=createImage;

},{}],7:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Game=void 0;var _keyboard=require("./keyboard.js");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var Game=function(){function e(t,i){_classCallCheck(this,e),i=i||{},this._canvas=t,this.theme={bg:i.bg||"#FFF",fg:i.fg||"#000",fontFace:i.fontFace||"sans"},this.keys=(0,_keyboard.createKeyStore)(t),this.mouse=null,this.rc={}}return _createClass(e,[{key:"width",get:function(){return this._canvas.width}},{key:"height",get:function(){return this._canvas.height}},{key:"minDim",get:function(){return Math.min(this.width,this.height)}},{key:"maxDim",get:function(){return Math.max(this.width,this.height)}}]),e}();exports.Game=Game;

},{"./keyboard.js":8}],8:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getName=getName,exports.getCode=getCode,exports.createKeyStore=createKeyStore;var standardNames={OS:"Meta",Scroll:"ScrollLock"," ":"Spacebar",Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Del:"Delete",Crsel:"CrSel",Exsel:"ExSel",Esc:"Escape",Apps:"ContextMenu",Nonconvert:"NonConvert",RomanCharacters:"Romaji",HalfWidth:"Hankaku",FullWidth:"Zenkaku",MozHomeScreen:"GoHome",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",FastFwd:"MediaFastForward",VolumeUp:"AudioVolumeUp",VolumeDown:"AudioVolumeDown",VolumeMute:"AudioVolumeMute",Live:"TV",Zoom:"ZoomToggle",SelectMedia:"LaunchMediaPlayer",MediaSelect:"LaunchMediaPlayer",Decimal:".",Multiply:"*",Add:"+",Divide:"/",Subtract:"-"};function getName(e){var t=e.key||"Unidentified";return 1===t.length&&(t=t.toUpperCase()),standardNames[t]||t}function getCode(e){return"$"+(e.code||"Unidentified")}function createKeyStore(e){var t={};return e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),e.addEventListener("keydown",function(e){var o=getName(e),a=getCode(e);t[o]|=1<<e.location,t[a]=!0,e.preventDefault()},!1),e.addEventListener("keyup",function(e){var o=getName(e),a=getCode(e);t[o]&=~(1<<e.location),t[o]||delete t[o],t[a]&&delete t[a],e.preventDefault()},!1),t}

},{}],9:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LoadGlobalResources=void 0;var _scene=require("./scene.js"),_ctxlib=require("./ctxlib.js"),resources=_interopRequireWildcard(require("./resources.js"));function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=o?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LoadGlobalResources=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,_scene.Scene),_createClass(t,[{key:"init",value:function(e,t){var r=this;this.ignoreBlur=!0,this.time=0,this.done=!1,this.failed=!1,resources.load(e,this.game.rc).then(function(){r.done=!0},function(e){throw r.failed=!0,e}),this.nextScene=t}},{key:"update",value:function(e){if(this.time+=e,this.done)return this.nextScene}},{key:"draw",value:function(e){if((0,_ctxlib.background)(e,this.game.theme.bg),!(this.done||this.time<100)){var t=Math.min(this.game.width,this.game.height),r=this.time/150-Math.PI/2;e.fillStyle=this.game.theme.fg,e.font="20pt "+this.game.theme.fontFace+", sans",e.textAlign="center",e.textBaseline="top",e.fillText(this.failed?"Failed to load resources!":"Loading...",this.game.width/2,5,this.game.width),this.failed||(e.strokeStyle="hsl("+360*(Math.sin(r/4)+1)/2+", 50%, 50%)",e.lineWidth=t/32,e.lineCap="round",e.beginPath(),e.arc(this.game.width/2,this.game.height/2,t/8,r-Math.PI/2,r),e.stroke())}}}]),t}();exports.LoadGlobalResources=LoadGlobalResources;

},{"./ctxlib.js":6,"./resources.js":11,"./scene.js":12}],10:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameLoop=void 0;var _ctxlib=require("./ctxlib.js");function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var GameLoop=function(){function t(e,i){_classCallCheck(this,t),i=i||{},this.canvas=e,this.ctx=e.getContext("2d"),this.maxTimeStep=i.maxTimeStep||35,this.lastTime=-1/0,this.focused=!1}return _createClass(t,[{key:"start",value:function(t,e){this.adjustDimensions(),this.scene=e.construct(t),requestAnimationFrame(this._mainLoop.bind(this,!0))}},{key:"adjustDimensions",value:function(){var t=!1;return this.canvas.width!==this.canvas.clientWidth&&(this.canvas.width=this.canvas.clientWidth,t=!0),this.canvas.height!==this.canvas.clientHeight&&(this.canvas.height=this.canvas.clientHeight,t=!0),t}},{key:"_mainLoop",value:function(t,e){var i=this;requestAnimationFrame(this._mainLoop.bind(this,!1));var s=this.scene,a=this.focused;this.focused=document.hasFocus()||s.ignoreBlur;var n=this.adjustDimensions();if(this.focused&&a){var o=Math.min(e-this.lastTime,this.maxTimeStep),c=s.update(o);c&&(this.scene=c.construct(s))}(this.focused||a||n||t)&&(0,_ctxlib.drawWrapper)(this.ctx,function(){s.draw(i.ctx,!i.focused)}),this.lastTime=e}}]),t}();exports.GameLoop=GameLoop;

},{"./ctxlib.js":6}],11:[function(require,module,exports){
"use strict";function _slicedToArray(r,t){return _arrayWithHoles(r)||_iterableToArrayLimit(r,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(r,t){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r)){var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=r[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!t||e.length!==t);n=!0);}catch(r){o=!0,i=r}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function pairsToObj(r,t){t=t||{};var e=!0,n=!1,o=void 0;try{for(var i,a=r[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=_slicedToArray(i.value,2),l=u[0],c=u[1];t[l]=c}}catch(r){n=!0,o=r}finally{try{e||null==a.return||a.return()}finally{if(n)throw o}}return t}function load(r,t){return Promise.all(Object.keys(r).filter(Object.prototype.hasOwnProperty.bind(r)).map(function(t){return r[t].then(function(r){return[t,r]})})).then(function(r){return pairsToObj(r,t)})}function getXHR(r){return new Promise(function(t,e){var n=new XMLHttpRequest;n.open("GET",r),n.onload=function(){return t(n)},n.onerror=function(){return e(n)},n.send()})}function getJSON(r){return getXHR(r).then(function(r){return JSON.parse(r.responseText)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.load=load,exports.getXHR=getXHR,exports.getJSON=getJSON;

},{}],12:[function(require,module,exports){
"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Scene=void 0;var SceneConstructor=function(){function e(t,r){_classCallCheck(this,e),this._obj=t,this._args=r,this._constructed=!1}return _createClass(e,[{key:"construct",value:function(e){var t;return this._constructed?this._obj:(e instanceof Scene?(this._obj.game=e.game,this._obj.inherit(e)):this._obj.game=e,(t=this._obj).init.apply(t,_toConsumableArray(this._args)),this._constructed=!0,this._obj)}}]),e}(),Scene=function(){function e(){_classCallCheck(this,e);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return new SceneConstructor(this,r)}return _createClass(e,[{key:"construct",value:function(e){return this}},{key:"inherit",value:function(e){}},{key:"init",value:function(){}},{key:"update",value:function(e){}},{key:"draw",value:function(e,t){}}]),e}();exports.Scene=Scene;

},{}],13:[function(require,module,exports){
"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Transform=exports.Vec2=void 0;var Vec2=function(){function t(i,e){_classCallCheck(this,t),this.set(i,e)}return _createClass(t,[{key:"set",value:function(t,i){this.x=t||0,this.y=i||0}},{key:"copy",value:function(){return new this.constructor(this.x,this.y)}},{key:"toString",value:function(){var t=this.constructor.name;return"[object ".concat(t," <").concat(this.x,", ").concat(this.y,">]")}},{key:"add",value:function(t){return new this.constructor(this.x+t.x,this.y+t.y)}},{key:"iadd",value:function(t){this.x+=t.x,this.y+=t.y}},{key:"sub",value:function(t){return new this.constructor(this.x-t.x,this.y-t.y)}},{key:"isub",value:function(t){this.x-=t.x,this.y-=t.y}},{key:"mul",value:function(t){return new this.constructor(this.x*t,this.y*t)}},{key:"imul",value:function(t){this.x*=t,this.y*=t}},{key:"div",value:function(t){return new this.constructor(this.x/t,this.y/t)}},{key:"idiv",value:function(t){this.x/=t,this.y/=t}},{key:"neg",value:function(){return new this.constructor(-this.x,-this.y)}},{key:"ineg",value:function(){this.x=-this.x,this.y=-this.y}},{key:"perp",value:function(){return new this.constructor(-this.y,this.x)}},{key:"iperp",value:function(){var t=this.x,i=this.y;this.x=-i,this.y=t}},{key:"trf",value:function(t){return new this.constructor(t.a*this.x+t.c*this.y+t.e,t.b*this.x+t.d*this.y+t.f)}},{key:"itrf",value:function(t){this.x=t.a*this.x+t.c*this.y+t.e,this.y=t.b*this.x+t.d*this.y+t.f}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"mag",value:function(){return Math.sqrt(this.dot(this))}},{key:"unit",value:function(){return this.div(this.mag())}},{key:"iunit",value:function(){this.idiv(this.mag())}},{key:"eq",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"isNaN",value:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){return isNaN(this.x)||isNaN(this.y)})},{key:"isFinite",value:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){return isFinite(this.x)&&isFinite(this.y)})},{key:Symbol.iterator,value:function(){return[this.x,this.y][Symbol.iterator]()}}],[{key:"from",value:function(t){if("x"in t&&"y"in t)return new this(t.x,t.y);var i=Array.from(t);if(2===i.length)return new this(i[0],i[1]);throw new TypeError("Can't convert ".concat(t," to 2D vector"))}},{key:"fromPolar",value:function(t,i){return new this(t*Math.cos(i),t*Math.sin(i))}},{key:"average",value:function(t){return t.reduce(function(t,i){return t.add(i)}).div(t.length)}}]),t}();exports.Vec2=Vec2;var Transform=function(){function t(i,e,s,n,r,h){_classCallCheck(this,t),arguments.length?this.setTransform(i,e,s,n,r,h):this.resetTransform()}return _createClass(t,[{key:"setTransform",value:function(t,i,e,s,n,r){this.a=t,this.b=i,this.c=e,this.d=s,this.e=n,this.f=r}},{key:"resetTransform",value:function(){this.setTransform(1,0,0,1,0,0)}},{key:"transform",value:function(t,i,e,s,n,r){this.setTransform(this.a*t+this.c*i,this.b*t+this.d*i,this.a*e+this.c*s,this.b*e+this.d*s,this.a*n+this.c*r+this.e,this.b*n+this.d*r+this.f)}},{key:"rotate",value:function(t){var i=Math.cos(t),e=Math.sin(t);this.setTransform(this.a*i+this.c*e,this.b*i+this.d*e,this.c*i-this.a*e,this.d*i-this.b*e,this.e,this.f)}},{key:"translate",value:function(t,i){this.setTransform(this.a,this.b,this.c,this.d,this.a*t+this.c*i+this.e,this.b*t+this.d*i+this.f)}},{key:"scale",value:function(t,i){void 0===i&&(i=t),this.setTransform(this.a*t,this.b*t,this.c*i,this.d*i,this.e,this.f)}},{key:Symbol.iterator,value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f][Symbol.iterator]()}}],[{key:"fromRotation",value:function(t,i){var e=0,s=0;if(i){var n=[i.x,i.y];e=n[0],s=n[1]}var r=Math.cos(t),h=Math.sin(t);return new this(r,h,-h,r,e,s)}}]),t}();exports.Transform=Transform;

},{}],14:[function(require,module,exports){
"use strict";var _ctxlib=require("./engine/ctxlib.js"),_vmath=require("./engine/vmath.js"),_collision=require("./engine/collision.js"),_camera=require("./engine/camera.js"),_loop=require("./engine/loop.js"),_game=require("./engine/game.js"),_scene=require("./engine/scene.js"),_loadingScene=require("./engine/loading-scene.js"),_resources=require("./engine/resources.js"),_shape=require("./shape.js"),_asteroid=require("./asteroid.js"),_ship=require("./ship.js"),_utils=require("./utils.js");function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var i=[],r=!0,a=!1,s=void 0;try{for(var o,n=t[Symbol.iterator]();!(r=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){a=!0,s=t}finally{try{r||null==n.return||n.return()}finally{if(a)throw s}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var GameOverScene=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,_scene.Scene),_createClass(e,[{key:"inherit",value:function(t){this.background=t}},{key:"update",value:function(t){if(this.game.keys.R)return new AsteroidalLander}},{key:"draw",value:function(t){t.save(),this.background.draw(t),t.restore(),(0,_ctxlib.background)(t,"rgba(0, 0, 100, 0.5)"),t.fillStyle="#FFF",t.font="40px monospace",t.textBaseline="middle",t.textAlign="center",t.fillText("Press [R] to restart",this.game.width/2,this.game.height/2,this.game.width)}}]),e}(),ExplosionScene=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,_scene.Scene),_createClass(e,[{key:"inherit",value:function(t){this.asteroid=t.asteroid,this.cam=t.cam}},{key:"init",value:function(t){this.fragments=t,this.time=0}},{key:"update",value:function(t){this.time+=t;var e=Math.min(this.cam.zoom*this.cam.zoom,1);if(this.cam.zoom-=e*(t/50),this.cam.zoom<.01&&(this.cam.zoom=.01,this.time>5e3))return new GameOverScene;var i=!0,r=!1,a=void 0;try{for(var s,o=this.fragments[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var n=s.value;n.gravitate(this.asteroid,t),n.update(t);for(var h=_slicedToArray(this.asteroid.getSlice(n),2),l=h[0],c=h[1],m=l;m<=c;m++){var u=this.asteroid.getPoint(m),f=this.asteroid.getPoint(m+1),p=(0,_collision.rtripolycol)(this.asteroid.pos,u,f,n.getBounds());p&&n.collide(p)}}}catch(t){r=!0,a=t}finally{try{i||null==o.return||o.return()}finally{if(r)throw a}}}},{key:"draw",value:function(t){(0,_ctxlib.background)(t,"#000"),t.translate(this.game.width/2,this.game.height/2),this.cam.applyTransform(t);var e=!0,i=!1,r=void 0;try{for(var a,s=this.fragments[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){a.value.draw(t,this.cam)}}catch(t){i=!0,r=t}finally{try{e||null==s.return||s.return()}finally{if(i)throw r}}this.asteroid.draw(t,this.cam)}}]),e}(),AsteroidalLander=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,_scene.Scene),_createClass(e,[{key:"init",value:function(){this.frames=0,this.asteroid=new _asteroid.Asteroid(5e3,200,this.game.rc.hatching);var t=this.asteroid.maxRadius+400;this.ship=new _ship.Ship(this.game.rc.cityShipData,{pos:new _vmath.Vec2(0,-t),vel:new _vmath.Vec2(Math.sqrt(this.asteroid.grav/t),0),theta:2*Math.random()*Math.PI,crest:.3,sfric:.9,dfric:.7,fuel:1.5}),this.maxDt=0,this.framesSinceMaxDt=0,this.cam=new _camera.Camera,this.cam.follow(this.ship),this.cam.zoom=1/350,this.cam.animZoom(1/15,2500),this.regimes=[{enter:0,exit:700,zoom:1/3,ttime:500},{enter:300,exit:6e3,zoom:1/15,ttime:1e3},{enter:5e3,exit:11e3,zoom:.01,ttime:1500},{enter:1e4,exit:0,zoom:.002,ttime:2e3}],this.curRegime=this.regimes[0]}},{key:"update",value:function(t){if(this.frames++,this.game.keys.R&&this.ship.fuel<=0)return new e;this.game.keys.R||t>=this.maxDt?(this.framesSinceMaxDt=0,this.maxDt=t,console.log("hit max of ",t,"frame:",this.frames)):this.framesSinceMaxDt++,this.game.keys.Spacebar&&(t*=10),this.cam.update(t),this.ship.gravitate(this.asteroid,t);var i=this.game.keys.$KeyW||this.game.keys.ArrowUp,r=this.game.keys.$KeyS||this.game.keys.ArrowDown,a=this.game.keys.$KeyA||this.game.keys.ArrowLeft,s=this.game.keys.$KeyD||this.game.keys.ArrowRight;this.ship.update(t,{turnLeft:a||r&&this.ship.omega>=this.ship.thrustTorque*t,turnRight:s||r&&this.ship.omega<=-this.ship.thrustTorque*t,thrustForward:i});for(var o=-1,n=[],h=this.ship.vel.copy(),l=!1,c=!0,m=_slicedToArray(this.asteroid.getSlice(this.ship),2),u=m[0],f=m[1],p=u;p<=f;p++){var g=this.asteroid.getPoint(p),y=this.asteroid.getPoint(p+1);o=Math.max(o,Math.max(g.mag(),y.mag()));var d=(0,_collision.rtripolycol)(this.asteroid.pos,g,y,this.ship.getBounds());if(d){n.push(d.norm);var b=this.ship.shape.region.vulnerable.trfPoints(this.ship.getTransform());(0,_collision.rtripolycol)(this.asteroid.pos,g,y,b)&&(l=!0),this.asteroid.isCool(p)||(c=!1),this.ship.collide(d)}}var _=this.ship.pos.sub(this.asteroid.pos).mag()-(o+this.ship.shape.radius);if(_<this.curRegime.enter||_>this.curRegime.exit){var v=!0,w=!1,x=void 0;try{for(var S,k=this.regimes[Symbol.iterator]();!(v=(S=k.next()).done);v=!0){var A=S.value;if(_<A.enter)break;this.curRegime=A}}catch(t){w=!0,x=t}finally{try{v||null==k.return||k.return()}finally{if(w)throw x}}}if(this.cam.animZoom(this.curRegime.zoom,this.curRegime.ttime),this.stable=!1,n.length){var T=_vmath.Vec2.average(n).unit(),P=h.sub(this.ship.vel).mag(),C=this.ship.vel.mag();if(l||P>.05)return new ExplosionScene(this.ship.explode(T));var M=_vmath.Vec2.fromPolar(1,this.ship.theta);if(this.stable=M.dot(T)>.99&&C<2e-4&&Math.abs(this.ship.omega)<6e-7,c&&this.stable)return this.cam.zoom=.5,new GameOverScene}}},{key:"draw",value:function(t,e){var i=this.cam;i.view=this.game.minDim/this.ship.shape.radius/2,i.rotation=-this.asteroid.angleFor(this.ship.pos)-Math.PI/2,(0,_ctxlib.background)(t,"#000"),t.save(),t.translate(this.game.width/2,this.game.height/2),i.applyTransform(t),this.ship.draw(t,i),this.asteroid.draw(t,i),this.ship.drawInfo(t,i),t.restore(),t.fillStyle="rgba(15,15,15,0.5)",t.fillRect(this.game.width/2,0,this.game.width,40),t.fillStyle="rgba(80,80,80,0.5)",t.fillRect(0,0,this.game.width/2,40),t.fillStyle="rgba(230,210,50,0.5)",t.fillRect(0,0,this.game.width*this.ship.fuel/2,40),this.ship.fuel<=.2&&new Date%2e3<700&&(t.font="40px monospace",t.textBaseline="top",t.textAlign="start",t.fillStyle="#fb0",t.fillText(this.ship.fuel>0?"FUEL LOW":"NO FUEL",5,5,this.game.width/2-10)),this.ship.fuel<=0&&(t.font="15px monospace",t.textBaseline="top",t.textAlign="start",t.fillStyle="#FFF",t.fillText("Press [R] to restart",5,45,this.game.width/2-10)),this.framesSinceMaxDt<30?t.fillStyle="#FE4":t.fillStyle="#FFF",t.textBaseline="top",t.font="15px monospace",t.textAlign="start",t.textAlign="end",t.fillStyle="#4DF",t.fillText("Altitude: "+(0,_utils.toMetric)(.6*this.ship.getAltitude(this.asteroid),"m",3,.01),this.game.width-5,5,this.game.width/2-10);var r=this.ship.vel.mag();t.fillStyle=(0,_ship.speedColor)(r,.05),t.fillText((r>Math.sqrt(2*this.asteroid.grav/this.ship.pos.mag())?"(ESC)":"")+" Velocity: "+(0,_utils.toMetric)(600*r,"m/s",3,.01),this.game.width-5,25,this.game.width/2-10),t.fillStyle="#888",t.textAlign="center",t.save(),t.rect(this.game.width/2,this.game.height/2,this.game.width,this.game.height),t.clip();var a=this.game.minDim/8/this.asteroid.maxRadius;t.translate(this.game.width-this.game.minDim/4,this.game.height-this.game.minDim/4),t.scale(a,a),t.strokeStyle="rgba(140, 140, 112, 0.75)",t.fillStyle="rgba(140, 140, 112, 0.15)";var s=1/a;t.lineWidth=1.5*s,this.asteroid.shape.draw(t),t.fill();var o=!0,n=!1,h=void 0;try{for(var l,c=this.asteroid.cool[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var m=l.value;if(!(Math.random()<.05)){t.fillStyle="rgba(240, 0, 128, 0.6)",t.beginPath();var u=Math.round(.7*(Math.random()-Math.random()));t.arc.apply(t,_toConsumableArray(this.asteroid.getPoint(m+u)).concat([2.3*s,0,2*Math.PI])),t.fill()}}}catch(t){n=!0,h=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw h}}var f=(this.game.minDim/4-8)*s,p=this.ship.pos.x-this.asteroid.pos.x,g=this.ship.pos.y-this.asteroid.pos.y;Math.abs(p)>f||Math.abs(g)>f?(p=Math.min(Math.max(p,-f),f),g=Math.min(Math.max(g,-f),f),new Date%1e3<500?t.fillStyle="rgba(68, 221, 255, 0.3)":t.fillStyle="rgba(68, 221, 255, 0.1)"):t.fillStyle="rgba(68, 221, 255, 0.75)",t.translate(p,g),t.rotate(this.ship.theta),t.beginPath(),t.moveTo(8*s,0),t.arc(0,0,2.3*s,Math.PI/2,3*Math.PI/2),t.closePath(),t.fill(),t.restore(),e&&((0,_ctxlib.background)(t,"rgba(0,0,0,0.75)"),t.textBaseline="middle",t.font="20pt ".concat(this.game.theme.fontFace),t.textAlign="center",t.fillStyle="#CCC",t.fillText("Click to focus",this.game.width/2,this.game.height/2,this.game.width))}}]),e}();window.addEventListener("load",function(t){var e=document.getElementById("asteroidal-lander");new _loop.GameLoop(e).start(new _game.Game(e,{bg:"#000",fg:"#DDD",fontFace:"monospace"}),new _loadingScene.LoadGlobalResources({cityShipData:(0,_resources.getJSON)("city-ship.json"),hatching:(0,_ctxlib.createImage)([100,100],function(t){(0,_ctxlib.background)(t,"rgb(10,10,10)"),t.strokeStyle="#554",t.lineCap="square",t.scale(2,2),t.beginPath(),t.moveTo(0,0),t.lineTo(50,50),t.moveTo(25,0),t.lineTo(50,25),t.moveTo(0,25),t.lineTo(25,50),t.moveTo(-1,49),t.lineTo(1,51),t.moveTo(49,-1),t.lineTo(51,1),t.stroke()})},new AsteroidalLander))});

},{"./asteroid.js":3,"./engine/camera.js":4,"./engine/collision.js":5,"./engine/ctxlib.js":6,"./engine/game.js":7,"./engine/loading-scene.js":9,"./engine/loop.js":10,"./engine/resources.js":11,"./engine/scene.js":12,"./engine/vmath.js":13,"./shape.js":15,"./ship.js":16,"./utils.js":17}],15:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiShape=exports.ExhaustShape=exports.Polygon=exports.Polyline=exports.Dots=void 0;var _vmath=require("./engine/vmath.js"),_utils=require("./utils.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=_superPropBase(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var PointShape=function(){function t(e){_classCallCheck(this,t),this.setData(e)}return _createClass(t,[{key:"setData",value:function(t){this.points=t.map(function(t){return _vmath.Vec2.from(t)}),this.radius=(0,_utils.mapMinMax)(this.points,function(t){return t.mag()}).maxKey}},{key:"trfPoints",value:function(t){return this.points.map(function(e){return e.trf(t)})}},{key:"copy",value:function(){return new this.constructor(this.points)}},{key:"draw",value:function(t){}}]),t}(),Dots=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,PointShape),_createClass(e,[{key:"draw",value:function(t){var e=t.fillStyle;t.fillStyle=t.strokeStyle;try{var r=!0,o=!1,n=void 0;try{for(var i,a=this.points[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;t.beginPath(),t.arc.apply(t,_toConsumableArray(s).concat([t.lineWidth/2,0,2*Math.PI])),t.fill()}}catch(t){o=!0,n=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw n}}}finally{t.fillStyle=e}}}]),e}();exports.Dots=Dots;var Polyline=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,PointShape),_createClass(e,[{key:"trace",value:function(t){t.beginPath();var e=this.points[Symbol.iterator]();t.moveTo.apply(t,_toConsumableArray(e.next().value));var r=!0,o=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;t.lineTo.apply(t,_toConsumableArray(s))}}catch(t){o=!0,n=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw n}}}},{key:"draw",value:function(t){this.trace(t),t.stroke()}}]),e}();exports.Polyline=Polyline;var Polygon=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,Polyline),_createClass(e,[{key:"trace",value:function(t){_get(_getPrototypeOf(e.prototype),"trace",this).call(this,t),t.closePath()}}],[{key:"rect",value:function(t,e,r,o){return new this([t,e],[t+r,e],[t+r,e+o],[t,e+o])}}]),e}();exports.Polygon=Polygon;var ExhaustShape=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,Polyline),_createClass(e,[{key:"setData",value:function(t){this.throttle=0,this.source=_vmath.Vec2.from(t.source),this.displacement=_vmath.Vec2.from(t.displacement),this.width=t.width}},{key:"copy",value:function(){return new this.constructor(this)}},{key:"points",get:function(){var t=this.displacement.perp().unit();return[this.source.add(t.mul(this.width/2)),this.source.add(this.displacement.mul(this.throttle)),this.source.sub(t.mul(this.width/2))]}}]),e}();exports.ExhaustShape=ExhaustShape;var MultiShape=function(){function t(e,r){for(var o in _classCallCheck(this,t),r=r||defaultShapeNames,this.nonDecorative={},this.shapes=Object.create(this.nonDecorative),this.region={},e){var n=r[e[o].kind];if(!n)throw new ReferenceError("Unknown shape kind: "+e[o].kind);var i=new n(e[o].data);"@"===o.charAt(0)?this.region[o.substring(1)]=i:e[o].decorative?this.shapes[o]=i:this.nonDecorative[o]=i}if(!this.region.bounds)throw new ReferenceError("Shape has no @bounds region");this.radius=this.region.bounds.radius}return _createClass(t,[{key:"draw",value:function(t){for(var e in this.shapes)this.shapes[e].draw(t)}}]),t}();exports.MultiShape=MultiShape;var defaultShapeNames={open:Polyline,closed:Polygon,dot:Dots,exhaust:ExhaustShape};

},{"./engine/vmath.js":13,"./utils.js":17}],16:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.speedColor=speedColor,exports.Fragment=exports.Ship=exports.PhysicsObject=void 0;var _vmath=require("./engine/vmath.js"),_shape=require("./shape.js"),_utils=require("./utils.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var s=_superPropBase(t,e);if(s){var o=Object.getOwnPropertyDescriptor(s,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function speedColor(t,e){var r=Math.abs(t),s=r/(r+e),o=s*Math.PI/2,n=255*Math.cos(o);return"rgb("+255*Math.sin(o)+", "+1020*s*(1-s)+", "+n+")"}var PhysicsObject=function(){function t(e,r){_classCallCheck(this,t),this.shape=e,r=r||{},this.pos=r.pos||new _vmath.Vec2,this.vel=r.vel||new _vmath.Vec2,this.theta=r.theta||0,this.omega=r.omega||0,this.crest=r.crest||0,this.ciner=r.ciner||Math.pow(this.shape.radius,2)/2,this.sfric=r.sfric||0,this.dfric=r.dfric||0}return _createClass(t,[{key:"applyImpulse",value:function(t,e){this.vel.iadd(t),void 0!==e&&(this.omega+=e.cross(t)/this.ciner)}},{key:"gravitate",value:function(t,e){this.applyImpulse(this.pos.mul(-t.grav*e).div(Math.pow(this.pos.sub(t.pos).mag(),3)))}},{key:"pointVel",value:function(t){return this.vel.add(t.perp().mul(this.omega))}},{key:"collide",value:function(t){var e=_vmath.Vec2.average(t.intersections).sub(this.pos);this.pos.iadd(t.norm.mul(t.depth));var r=this.pointVel(e),s=(t.norm.perp(),e.cross(t.norm)),o=-r.dot(t.norm)*(1+this.crest)/(1+s*s/this.ciner);this.applyImpulse(t.norm.mul(o),e);var n=(r=this.pointVel(e)).sub(t.norm.mul(t.norm.dot(r))),a=n.mag();a>o*this.sfric&&(a=o*this.dfric);var i=n.unit(),u=e.cross(i);this.applyImpulse(i.mul(-a/(1+u*u/this.ciner)),e)}},{key:"getTransform",value:function(){var t=new _vmath.Transform;return t.translate(this.pos.x,this.pos.y),t.rotate(this.theta),t}},{key:"getBounds",value:function(){return(this.shape.region&&this.shape.region.bounds||this.shape).trfPoints(this.getTransform())}},{key:"draw",value:function(t,e){t.save(),t.transform.apply(t,_toConsumableArray(this.getTransform())),t.lineWidth=e.scale<1?1/e.scale:1,t.strokeStyle="#FFF",this.shape.draw(t),t.restore()}},{key:"update",value:function(t){this.theta+=this.omega*t,this.pos.iadd(this.vel.mul(t))}}]),t}();exports.PhysicsObject=PhysicsObject;var Ship=function(t){function e(t,r){var s;return _classCallCheck(this,e),(s=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,new _shape.MultiShape(t),r))).throttle=0,s.fuel=1,s.fmul=1/(r&&r.fuel||1),s.thrustTorque=3e-7,s.thrustForce=4e-5,s}return _inherits(e,PhysicsObject),_createClass(e,[{key:"getBounds",value:function(){return this.shape.region.bounds.trfPoints(this.getTransform())}},{key:"drawInfo",value:function(t,e){t.save(),t.transform.apply(t,_toConsumableArray(this.getTransform())),t.scale(1/e.scale,1/e.scale);var r=this.shape.radius*e.scale,s=this.vel.mag();if(s>.01){var o=this.vel.div(s);t.save(),t.rotate(-this.theta),t.fillStyle=t.strokeStyle=speedColor(s,.05),t.beginPath(),t.arc.apply(t,_toConsumableArray(o.mul(r+5)).concat([3,0,2*Math.PI])),t.fill(),t.beginPath(),t.moveTo.apply(t,_toConsumableArray(o.mul(r+5))),t.lineTo.apply(t,_toConsumableArray(o.mul(r+5+Math.min(20,100*s)))),t.lineWidth=2.5,t.stroke(),t.restore()}e.scale<.3&&(t.fillStyle="#4DF",t.beginPath(),t.moveTo(r+25,0),t.lineTo(r+5,5),t.lineTo(r+5,-5),t.closePath(),t.fill()),t.restore()}},{key:"_randExhaust",value:function(t){return t*(.75+.25*(Math.random()-Math.random()))}},{key:"_updateTurnExhaustL",value:function(t){var e=this._randExhaust(t),r=this._randExhaust(t);this.shape.shapes.turningExhaustL.throttle=e,this.shape.shapes.counterExhaustR.throttle=r}},{key:"_updateTurnExhaustR",value:function(t){var e=this._randExhaust(t),r=this._randExhaust(t);this.shape.shapes.turningExhaustR.throttle=e,this.shape.shapes.counterExhaustL.throttle=r}},{key:"_updatePrimaryExhaust",value:function(){var t=this._randExhaust(this.throttle);this.shape.shapes.primaryExhaust.throttle=t}},{key:"update",value:function(t,r){if(r=r||{},this.fuel<=0&&(r={}),this._updateTurnExhaustL(r.turnLeft?1:0),r.turnLeft&&(this.omega-=this.thrustTorque*t,this.fuel-=5e-6*this.fmul*t),this._updateTurnExhaustR(r.turnRight?1:0),r.turnRight&&(this.omega+=this.thrustTorque*t,this.fuel-=5e-6*this.fmul*t),r.thrustForward){this.throttle+=.001*t,this.throttle=Math.min(this.throttle,1);var s=this.throttle*this.thrustForce*t;this.vel.iadd(_vmath.Vec2.fromPolar(s,this.theta)),this.fuel-=3e-5*(2-this.throttle)*this.fmul*t}else this.throttle=0;this._updatePrimaryExhaust(),this.fuel=Math.max(this.fuel,0),window.fuel=this.fuel,_get(_getPrototypeOf(e.prototype),"update",this).call(this,t)}},{key:"explode",value:function(t){var e=t.perp().mul(.75),r=[];for(var s in this.shape.nonDecorative){var o=this.shape.nonDecorative[s],n=Math.random()*Math.PI,a=Math.random()/5,i=t.mul(a*Math.sin(n));i.iadd(e.mul(a*Math.cos(n)));var u=(Math.random()-Math.random())/900;r.push(new Fragment(this,o,i,u))}return r}},{key:"getAltitude",value:function(t){return(0,_utils.mapMinMax)(this.getBounds(),function(e){var r=t.indexForAngle(t.angleFor(e)),s=t.getPoint(r),o=t.getPoint(r+1).sub(s),n=t.pos.sub(e).unit();return s.sub(e).cross(o)/n.cross(o)}).minKey}}]),e}();exports.Ship=Ship;var Fragment=function(t){function e(t,r,s,o){_classCallCheck(this,e),s=s||new _vmath.Vec2,o=o||0;var n=r.points.reduce(function(t,e){return t.add(e)}).div(r.points.length);return r=new r.constructor(r.points.map(function(t){return t.sub(n)})),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,r,{pos:n.trf(t.getTransform()),vel:t.pointVel(n).add(s),theta:t.theta,omega:t.omega+o,crest:t.crest,sfric:t.sfric,dfric:t.dfric}))}return _inherits(e,PhysicsObject),e}();exports.Fragment=Fragment;

},{"./engine/vmath.js":13,"./shape.js":15,"./utils.js":17}],17:[function(require,module,exports){
"use strict";function ceilPow(t,a){var r=a?Math.log(a):Math.LN2;return Math.exp(r*Math.ceil(Math.log(t)/r))}function mapMinMax(t,a){var r,e,o,n,i=t[Symbol.iterator](),M=i.next().value;r=e=M,o=n=a?a(M):M;var c=!0,h=!1,l=void 0;try{for(var u,m=i[Symbol.iterator]();!(c=(u=m.next()).done);c=!0){var x=u.value,f=a?a(x):x;f<o?(r=x,o=f):f>n&&(e=x,n=f)}}catch(t){h=!0,l=t}finally{try{c||null==m.return||m.return()}finally{if(h)throw l}}return{min:r,max:e,minKey:o,maxKey:n}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ceilPow=ceilPow,exports.mapMinMax=mapMinMax,exports.toMetric=toMetric;var PREFIXES=["y","z","a","f","p","n","mc","m","","k","M","G","T","P","E","Z","Y"];function magnitude(t){return 0===t?0:Math.floor(Math.log(Math.abs(t))*Math.LOG10E)}function toMetric(t,a,r,e){if(a=a||"",r=r||3,!isFinite(t))return"".concat(t," ").concat(a);e&&(t=Math.round(t/e)*e);var o=Math.pow(10,1+magnitude(t)-r),n=Math.round(t/o)*o,i=magnitude(n),M=-8;if(e){var c=magnitude(e);M=Math.min(Math.max(Math.ceil(c/3),M),8),r-=Math.max(0,c-i+r-1)}var h=3*Math.min(Math.max(Math.floor(i/3),M),8),l=r-(1+i-h),u=(n/Math.pow(10,h)).toFixed(Math.max(0,l));return a=PREFIXES[8+Math.floor(h/3)]+a,"".concat(u," ").concat(a)}

},{}]},{},[14])
//# sourceMappingURL=asteroidal-lander.js.map
